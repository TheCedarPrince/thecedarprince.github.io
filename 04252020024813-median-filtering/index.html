<!doctype html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> <!--Adapted from Seth Axen's @sethaxen-->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Primary Meta Tags -->
<meta name="title" content="Median Filtering">
<meta name="description" content="An overview on how to use and implement a median filter">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="article">
<meta property="og:title" content="Median Filtering">
<meta property="og:description" content="An overview on how to use and implement a median filter">
<meta property="og:image" content="https://jacobzelko.com/assets/profile.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary">
<meta property="twitter:creator" content="Jacob_Zelko">
<meta property="twitter:title" content="Median Filtering">
<meta property="twitter:description" content="An overview on how to use and implement a median filter">
<meta property="twitter:image" content="https://jacobzelko.com/assets/profile.png">
  <link rel="stylesheet" href="/libs/katex/katex.min.css">
   <link rel="stylesheet" href="/libs/highlight/github.min.css">
 
    <link rel="stylesheet" href="/css/franklin.css">
    <link rel="stylesheet" href="/css/basic.css">
    <link rel="icon" href="/assets/favicon.ico"> 
    <title>Median Filtering</title> 

    <!--SUPPORT FOR DARKMODE-JS-->
    <script src="/libs/darkmode/darkmode-js.min.js"></script>
    <script>
        function addDarkmodeWidget()
        {
            const options = {
                bottom: '32px', /* default: '32px' */
                right: '32px', /* default: '32px' */
                left: 'unset', /* default: 'unset' */
                time: '.0s', /* default: '0.3s' */
                mixColor: '#fff', /* default: '#fff' */
                backgroundColor: '#fff', /* default: '#fff' */
                buttonColorDark: '#100f2c', /* default: '#100f2c' */
                buttonColorLight: '#fff', /* default: '#fff' */
                saveInCookies: true, /* default: true, */
                label: 'ðŸŒ“', /* default: '' */
                autoMatchOsTheme: true /* default: true */
            };
            new Darkmode(options).showWidget();
        };
        window.addEventListener('DOMContentLoaded', addDarkmodeWidget);
    </script>

    <!--SUPPORT FOR ANALYTICS FROM GOATCOUNTER-->
    <script data-goatcounter="https://thecedarledge.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

    <!--SUPPORT FOR LUNR-->
    <script src="/libs/lunr/lunr.min.js"></script>
    <script src="/libs/lunr/lunr_index.js"></script>
    <script src="/libs/lunr/lunrclient.min.js"></script>

</head>


<body>
    <header>
    <div class="blog-name"><a href="/">the cedar ledge</a></div>
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="/archive">Archive</a></li>
            <li><a href="/resources">Resources</a></li>
        </ul>
        <img src="/assets/hamburger.png" id="menu-icon">
    </nav>
    </div>
</header>
 <div align="center">
       <form id="lunrSearchForm" name="lunrSearchForm">
           <input class="search-input" name="q" placeholder="Enter search term" type="text">
           <input type="submit" value="Search" formaction="/search/index.html">
       </form>
</div>
   
    <!-- Content appended here -->
<div class="franklin-content"><h1>Median Filtering</h1>
<p><strong>Date:</strong> April 25 2020</p>
<p><strong>Summary:</strong> An overview on how to use and implement a median filter</p>
<p><strong>Keywords:</strong> ##zettel #signalprocessing #noise #artifact #filtering #window #julialang #median #movingaverage #downsampling #archive</p>
<h1>Bibliography</h1>
<p>Not Available</p>
<h1>Table of Contents</h1>
<div class="franklin-toc"><ol><li><ol><li><a href="#algorithm">Algorithm</a><ol><li><a href="#additional_consideration">Additional Consideration</a></li></ol></li><li><a href="#example_implementation">Example Implementation</a><ol><li><a href="#output">Output</a></li></ol></li></ol></li><li><a href="#references">References</a></li><li><a href="#references__2">References</a></li><li><a href="#discussion">Discussion: </a></li></ol></div>
<p>It is a non-linear digital filtering technique, used to remove noise from an image or signal. The main idea of the median filter is to run through the signal value by value, replacing each value with the median of neighboring values. The pattern of neighbors is called the &quot;window&quot;, which slides, entry by entry, over the entire signal.</p>
<h3 id="algorithm"><a href="#algorithm" class="header-anchor">Algorithm</a></h3>
<p>An explanation of implementing the algorithm is given in example form:</p>
<p>Given the original signal, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>80</mn><mo separator="true">,</mo><mn>6</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x = (2, 3, 80, 6)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">80</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mclose">)</span></span></span></span>, a 1D Median Filter is applied as follows:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mn>1</mn><mo>=</mo><mi>m</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>80</mn><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">
y1 = med(2, 3, 80) = 3
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">80</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mn>2</mn><mo>=</mo><mi>m</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>80</mn><mo separator="true">,</mo><mn>6</mn><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>80</mn><mo stretchy="false">)</mo><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">
y2 = med(3, 80, 6) = med(3, 6, 80) = 6
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">80</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">80</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mn>3</mn><mo>=</mo><mi>m</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mn>80</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>80</mn><mo stretchy="false">)</mo><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">
y3 = med(80, 6, 2) = med(2, 6, 80) = 6
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">80</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">80</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mn>4</mn><mo>=</mo><mi>m</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mn>6</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>6</mn><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">
y4 = med(6, 2, 3) = med(2, 3, 6) = 3
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></span>
<p>Which yields the final filtered signal, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = (3, 6, 6, 3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>.</p>
<h4 id="additional_consideration"><a href="#additional_consideration" class="header-anchor">Additional Consideration</a></h4>
<p>In the example implementation, there is no value preceding the first value, thus the window &quot;wraps&quot; around the original to fulfill its window size.</p>
<p>There are other ways to handle filling the window other than wrapping such as:</p>
<ul>
<li><p>Avoiding selecting values directly located at either boundary of the signal.</p>
</li>
<li><p>Use other values from within the signal.</p>
</li>
<li><p>Shrink the window near the edges of the signal so that the window is always full.</p>
</li>
</ul>
<p>Furthermore, it is very good for salt-and-pepper noise/impulse noise &#40;e.g. noise that is caused by sharp and sudden disturbances in the image signal&#41;</p>
<h3 id="example_implementation"><a href="#example_implementation" class="header-anchor">Example Implementation</a></h3>
<pre><code class="julia hljs"><span class="hljs-keyword">using</span> Plots <span class="hljs-comment"># IMPORT FOR PLOTTING</span>
<span class="hljs-keyword">using</span> Statistics <span class="hljs-comment"># IMPORT FOR `median` FUNCTION</span>
<span class="hljs-keyword">using</span> LaTeXStrings <span class="hljs-comment"># IMPORT TO ENABLE LaTeX FORMATTING</span>
gr()

<span class="hljs-keyword">let</span>

    <span class="hljs-comment"># CHOOSE WINDOW AND INPUT VALUES OVER WHICH TO CALCULATE</span>
    input = <span class="hljs-number">0</span>:<span class="hljs-number">0.001</span>:<span class="hljs-number">1</span>
    window = <span class="hljs-number">30</span>
    sampling_rate = <span class="hljs-number">15</span>

    <span class="hljs-comment"># GENERATE GENERIC SIGNAL - IN THIS CASE sin(2Î )</span>
    signal = [sin(<span class="hljs-number">2</span> * <span class="hljs-literal">pi</span> * i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> input]

    <span class="hljs-comment"># ADDING RANDOM NOISE TO FUNCTION</span>
    noisy_signal = [sin(<span class="hljs-number">2</span> * <span class="hljs-literal">pi</span> * i) + rand([-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) * round(rand(), digits = <span class="hljs-number">2</span>)
                    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> input]

    <span class="hljs-comment"># FILTER THE SIGNAL USING A MEDIAN FILTER &amp; DOWNFILTERING USING A MEDIAN FILTER</span>
    downsampled_signal::<span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Float32</span>} = [noisy_signal[<span class="hljs-number">1</span>]]
    downsampled_input::<span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Float16</span>} = [<span class="hljs-number">0</span>]
    median_signal::<span class="hljs-built_in">Array</span>{<span class="hljs-built_in">Float32</span>} = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(signal)
        <span class="hljs-keyword">if</span> length(noisy_signal) - (window + i - <span class="hljs-number">1</span>) &lt; <span class="hljs-number">0</span>
            forward = noisy_signal[i:<span class="hljs-keyword">end</span>]
            wrap = noisy_signal[<span class="hljs-number">1</span>:abs(length(noisy_signal) - (window + i - <span class="hljs-number">1</span>))]
            append!(median_signal, median(vcat(forward, wrap)))

            <span class="hljs-comment"># SETTING SAMPLING RATE AND CREATING DOWNSAMPLED OUTPUT</span>
            <span class="hljs-keyword">if</span> i % sampling_rate == <span class="hljs-number">0</span>
                append!(downsampled_input, input[i])
                append!(downsampled_signal, median(vcat(forward, wrap)))
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">else</span>
            forward = noisy_signal[i:(window + i - <span class="hljs-number">1</span>)]
            append!(median_signal, median(forward))

            <span class="hljs-comment"># SETTING SAMPLING RATE AND CREATING DOWNSAMPLED OUTPUT</span>
            <span class="hljs-keyword">if</span> i % sampling_rate == <span class="hljs-number">0</span>
                append!(downsampled_input, input[i])
                append!(downsampled_signal, median(forward))
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>

    <span class="hljs-comment"># PLOT SIGNALS</span>
    append!(downsampled_input, input[<span class="hljs-keyword">end</span>])
    append!(downsampled_signal, noisy_signal[<span class="hljs-keyword">end</span>])
    plot(input, noisy_signal, label = <span class="hljs-string">&quot;Noisy Signal&quot;</span>, title = <span class="hljs-string">&quot;Example of Median Filter&quot;</span>)
    plot!(input, median_signal, label = <span class="hljs-string">&quot;Median Filtered Signal&quot;</span>, linewidth = <span class="hljs-number">3</span>)
    plot!(input, signal, label = <span class="hljs-string">L&quot;2\pi&quot;</span>, linewidth = <span class="hljs-number">5</span>)
    plot!(downsampled_input, downsampled_signal, linewidth = <span class="hljs-number">3</span>, color = :black,
          label = <span class="hljs-string">&quot;Downsampled Median Signal&quot;</span>)

<span class="hljs-keyword">end</span></code></pre>
<h4 id="output"><a href="#output" class="header-anchor">Output</a></h4>
<p><img src="/04252020025710.png" alt="median_filter" /></p>
<h2 id="references"><a href="#references" class="header-anchor">References</a></h2>
<h2 id="references__2"><a href="#references__2" class="header-anchor">References</a></h2>
<h2 id="discussion"><a href="#discussion" class="header-anchor">Discussion: </a></h2>
<script src="https://giscus.app/client.js"
    data-repo="TheCedarPrince/thecedarprince.github.io"
    data-repo-id="R_kgDOHRFrHA"
    data-category="General"
    data-category-id="DIC_kwDOHRFrHM4CPGIX"
    data-mapping="url"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>
<div class="page-foot">
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Jacob Zelko. Last modified: December 29, 2022.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div><!-- CONTENT ENDS HERE -->
    
        



    
    
        


    
  </body>
</html>
